<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Halima tr√§nar</title>

<style>
body{font-family:Arial;max-width:500px;margin:20px auto;padding:20px;background:#f5f5f5}
.container{background:white;padding:25px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,0.1);margin-bottom:20px}
input{width:100%;padding:12px;margin:8px 0;border:1px solid #ddd;border-radius:5px;font-size:14px}
button{background:#4CAF50;color:white;padding:12px 24px;border:none;border-radius:5px;margin:5px;cursor:pointer}
button:hover{background:#45a049}
.audio-btn{background:#2196F3;padding:8px 16px;font-size:12px}
.page{display:none}.page.active{display:block}
.question{font-size:18px;margin:15px 0;padding:15px;background:#f0f8ff;border-radius:5px;text-align:center}
.feedback{margin:10px 0;padding:10px;border-radius:5px;font-weight:bold;text-align:center}
.correct{background:#d4edda;color:#155724}
.incorrect{background:#f8d7da;color:#72121f}
.answer-box{background:#fff3cd;padding:15px;margin:10px 0;border-radius:5px;display:none}
.voice-selector{background:#f0f8ff;padding:10px;border-radius:5px;margin-bottom:10px}
select{width:100%;padding:8px}
</style>
</head>

<body>

<div id="info" class="container page active">
<h3>üìç Mina Uppgifter</h3>

<div class="voice-selector">
<label>V√§lj svensk r√∂st:</label>
<select id="voiceSelect"></select>
</div>

<label>Adress:</label>
<input id="adr" value="Gr√§nsholmsbacken 2">
<button class="audio-btn" onclick="speak('Din adress √§r ' + adr.value)">üîä</button>

<label>Telefon:</label>
<input id="tel" value="070 418 56 49">
<button class="audio-btn" onclick="speak('Ditt telefonnummer √§r ' + tel.value)">üîä</button>

<label>Personnummer:</label>
<input id="pers" value="19971231-8907">
<button class="audio-btn" onclick="speak(formatPN(pers.value))">üîä</button>

<div style="text-align:center;margin-top:15px">
<button onclick="train()">üéØ Tr√§na</button>
</div>
</div>

<div id="train" class="container page">
<h3>üéì Tr√§ning</h3>

<div class="question" id="qdiv"></div>

<input id="ans" placeholder="Skriv svaret">

<div style="text-align:center">
<button onclick="check()">‚úÖ Kontrollera</button>
<button onclick="nextQ()">üîÑ Ny fr√•ga</button>
<button onclick="back()">‚¨ÖÔ∏è Tillbaka</button>
</div>

<div id="fb"></div>

<div id="sol" class="answer-box">
<button class="audio-btn" onclick="speak('R√§tt svar √§r ' + cur.a)">üîä</button>
<div id="corr"></div>
</div>
</div>

<script>
let voices = [];
let selectedVoice = null;
let q = [];
let cur = {};

function loadVoices(){
    voices = speechSynthesis.getVoices();
    const sel = document.getElementById('voiceSelect');
    sel.innerHTML = '';

    const sv = voices.filter(v => v.lang.startsWith('sv'));

    if(!sv.length){
        alert('‚ö†Ô∏è Ingen svensk r√∂st installerad p√• denna enhet.');
        return;
    }

    sv.forEach((v,i)=>{
        const o = document.createElement('option');
        o.value = v.name;
        o.textContent = v.name;
        if(i===0){o.selected=true;selectedVoice=v;}
        sel.appendChild(o);
    });

    sel.onchange = () => {
        selectedVoice = voices.find(v=>v.name===sel.value);
    };
}

function speak(text, slow=false){
    speechSynthesis.cancel();
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'sv-SE';
    u.voice = selectedVoice;
    u.rate = slow ? 0.8 : 1.0;
    u.pitch = 1.0;
    speechSynthesis.speak(u);
}

function formatPN(pn){
    const c = pn.replace(/[-\s]/g,'');
    return `${c.substr(0,4)} ${c.substr(4,2)} ${c.substr(6,2)} ${c.substr(8,2)} ${c.substr(10,2)}`;
}

function train(){
    q=[
        {q:'Vad √§r din adress?',a:adr.value},
        {q:'Vad √§r ditt telefonnummer?',a:tel.value},
        {q:'Vad √§r ditt personnummer?',a:pers.value}
    ];
    info.classList.remove('active');
    trainDiv.classList.add('active');
    nextQ();
}

function nextQ(){
    cur = q[Math.floor(Math.random()*q.length)];
    qdiv.textContent = cur.q;
    ans.value='';
    fb.innerHTML='';
    sol.style.display='none';
}

function check(){
    if(ans.value.replace(/\s/g,'')===cur.a.replace(/\s|-/g,'')){
        fb.innerHTML='<div class="feedback correct">‚úÖ R√§tt!</div>';
        setTimeout(nextQ,1500);
    }else{
        fb.innerHTML='<div class="feedback incorrect">‚ùå Fel</div>';
        corr.textContent='R√§tt svar: '+cur.a;
        sol.style.display='block';
    }
}

function back(){
    trainDiv.classList.remove('active');
    info.classList.add('active');
}

window.onload=()=>{
    loadVoices();
    speechSynthesis.onvoiceschanged = loadVoices;
};

const info = document.getElementById('info');
const trainDiv = document.getElementById('train');
const qdiv = document.getElementById('qdiv');
const ans = document.getElementById('ans');
const fb = document.getElementById('fb');
const sol = document.getElementById('sol');
const corr = document.getElementById('corr');
</script>

</body>
</html>
